Wall Street Data Analysis Using VBA Script

Sub Analysis_1()

'Performed:
    'Created a loop through each year of stock data and and grab the total amount of volume each stock had over the year and displayed the ticker symbol to coincide with the total volume.

    
'Loop thru all WORKSHEETS
    For Each ws In Worksheets
        
        'Created a variable to hold the ticker, total stk volume, and lastrow of each wksht
        Dim Ticker As String
        
        'Dim TotalStkVol As Long - this was creating "overflow errors" same with
        'defining lastrow as a long because there's too many rows
        
        ws.Cells(1, 9).Value = "Ticker Symbol"
        ws.Cells(1, 10).Value = "Total Stock Volume"
        
        TotalStkVol = 0
        
        Dim SummaryTableTick As Integer
        SummaryTableTick = 2
        
        lastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row
        
        'setting up the for loop and conditionals
        For Row = 2 To lastrow
        
            If ws.Cells(Row + 1, 1).Value <> ws.Cells(Row, 1).Value Then
                
                'Set the Ticker Name
                Ticker = ws.Cells(Row, 1).Value
                
                'Add to volume total
                TotalStkVol = TotalStkVol + ws.Cells(Row, 7).Value
                
                'Print Ticker Name in the Summary Table
                ws.Range("I" & SummaryTableTick).Value = Ticker
                
                'Print the TotalStkVol to the Summary Table
                ws.Range("J" & SummaryTableTick).Value = TotalStkVol
                
                'add one to the summary table row
                SummaryTableTick = SummaryTableTick + 1
                
                'reset the TotalStkVol back to zero
                TotalStkVol = 0
                
            Else
                TotalStkVol = TotalStkVol + ws.Cells(Row, 7).Value
        
            End If
        
        Next Row
    
    Next ws
    
End Sub


Sub Analysis_2()

    'Performed:
        'Created a script that will loop through all the stocks and take the following info.
            'Yearly change from what the stock opened the year at to what the closing price was.
            'The percent change from the what it opened the year at to what it closed.
            'The total Volume of the stock
            'Ticker Symbol
            'You should also have conditional formatting that will highlight positive
            'change in green and negative change in red.

    
'Set up the loops thru all WORKSHEETS
    For Each ws In Worksheets

    'Declare all variables and define them
        Dim Ticker As String
        Dim TotalOpenPrice As Double
        Dim TotalClosePrice As Double
        Dim Yearly_Change As Double
        Dim Percent_Change As Double

        'define the variables within each wksht
        TotalStkVol = 0
        TotalOpenPrice = 0
        TotalClosePrice = 0
        Yearly_Change = TotalClosePrice - TotalOpenPrice

        Dim SummaryTableTick2 As Integer
        SummaryTableTick2 = 2
        
        'Set up SummaryTableTick2
        ws.Cells(1, 9).Value = "Ticker Symbol"
        ws.Cells(1, 10).Value = "Yearly Change"
        ws.Cells(1, 11).Value = "Percent Change"
        ws.Cells(1, 12).Value = "Total Stock Volume"
Wall Street Data Analysis Using VBA Script

Sub Analysis_1()

'Performed:
    'Created a loop through each year of stock data and and grab the total amount of volume each stock had over the year and displayed the ticker symbol to coincide with the total volume.

    
'Loop thru all WORKSHEETS
    For Each ws In Worksheets
        
        'Created a variable to hold the ticker, total stk volume, and lastrow of each wksht
        Dim Ticker As String
        
        'Dim TotalStkVol As Long - this was creating "overflow errors" same with
        'defining lastrow as a long because there's too many rows
        
        ws.Cells(1, 9).Value = "Ticker Symbol"
        ws.Cells(1, 10).Value = "Total Stock Volume"
        
        TotalStkVol = 0
        
        Dim SummaryTableTick As Integer
        SummaryTableTick = 2
        
        lastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row
        
        'setting up the for loop and conditionals
        For Row = 2 To lastrow
        
            If ws.Cells(Row + 1, 1).Value <> ws.Cells(Row, 1).Value Then
                
                'Set the Ticker Name
                Ticker = ws.Cells(Row, 1).Value
                
                'Add to volume total
                TotalStkVol = TotalStkVol + ws.Cells(Row, 7).Value
                
                'Print Ticker Name in the Summary Table
                ws.Range("I" & SummaryTableTick).Value = Ticker
                
                'Print the TotalStkVol to the Summary Table
                ws.Range("J" & SummaryTableTick).Value = TotalStkVol
                
                'add one to the summary table row
                SummaryTableTick = SummaryTableTick + 1
                
                'reset the TotalStkVol back to zero
                TotalStkVol = 0
                
            Else
                TotalStkVol = TotalStkVol + ws.Cells(Row, 7).Value
        
            End If
        
        Next Row
    
    Next ws
    
End Sub


